<div class="sides-container">
  <!-- LEFT: Unirse con código -->
  <div class="left-side">
    <h2>Unirse como participante</h2>
    <p>No necesitas cuenta</p>

    <div class="join-box">
      <input type="text" 
        [(ngModel)]="joinCode"
        (keyup.enter)="joinQuiz()"
        placeholder="# Ingresa el código del quiz"
        maxlength="6"
      />
      <button (click)="joinQuiz()" class="cursor-pointer">
        <mat-icon fontIcon="arrow_forward"></mat-icon>
      </button>
    </div>
  </div>

  <!-- RIGHT: Login form -->
  <div class="right-side">
    <div class="box-container">
      <div class="box">
        <div class="flex justify-center items-center mb-8">
          <img src="assets/logo-full.png" alt="EasyQuizzy" class="h-30 md:h-36" />
        </div>

        <h2 class="mb-6">Bienvenido de nuevo</h2>
        <p class="subtitle">Inicia sesión en tu cuenta de EasyQuizzy</p>

        @if (errorMessage()) {
          <app-error [message]="errorMessage() | errorMessage"></app-error>
        }

        <form [formGroup]="form" (ngSubmit)="onSubmit()" class="mt-4 space-y-3">
          <!-- Email -->
          <div>
            <input
              formControlName="email"
              type="email"
              placeholder="Correo electrónico"
              class="input"
              [class.border-red-400]="f.email.touched && f.email.invalid"
            />
            @if (f.email.touched && f.email.invalid) {
              <p class="error-text">
                @if (f.email.errors?.['required']) { El correo es obligatorio. }
                @else if (f.email.errors?.['email']) { Ingresa un correo válido. }
              </p>
            }
          </div>

          <!-- Contraseña -->
          <div>
            <input
              formControlName="password"
              type="password"
              placeholder="Contraseña"
              class="input"
              [class.border-red-400]="f.password.touched && f.password.invalid"
            />
            @if (f.password.touched && f.password.invalid) {
              <p class="error-text">
                @if (f.password.errors?.['required']) { La contraseña es obligatoria. }
                @else if (f.password.errors?.['minlength']) { Debe tener al menos 6 caracteres. }
              </p>
            }
          </div>

          <!-- Link forgot password -->
          <div class="text-right py-2">
            <a routerLink="/auth/forgot-password" class="link text-[var(--color-primary-hover)] hover:underline cursor-pointer transition">
              ¿Olvidaste tu contraseña?
            </a>
          </div>

          <!-- Botón principal -->
          <button type="submit" class="btn btn--primary mt-2 w-full" [disabled]="loading()">
            @if (loading()) {
              <span>Cargando...</span>
            } @else {
              <span>Iniciar sesión</span>
            }
          </button>
        </form>

        <p class="text-center mt-4">
          ¿No tienes una cuenta?
          <a routerLink="/auth/register" class="link text-[var(--color-primary-hover)] font-medium cursor-pointer hover:underline transition">
            Regístrate
          </a>
        </p>

        <!-- Google login -->
        <div id="googleButton" class="flex justify-center my-3 w-full"></div>
      </div>
    </div>
  </div>
</div>
